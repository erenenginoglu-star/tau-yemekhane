<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>TAÃœ Yemekhane Â· GiriÅŸ & KayÄ±t</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --ink: #111111;
      --subtle: #6e6e73;
      --border-soft: rgba(0,0,0,0.08);
      --shadow-soft: 0 14px 40px rgba(0,0,0,0.08);
    }

    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; height: 100%; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
        system-ui, -system-ui, "Segoe UI", sans-serif;
      /* Daha koyu, fotoÄŸrafÄ± Ã¶ne Ã§Ä±karan arka plan */
      background:
        radial-gradient(circle at 0 0, rgba(255,255,255,0.10) 0, transparent 55%),
        #05060a;
      color: var(--ink);
      position: relative;
      overflow-x: hidden;
    }

    /* DARK MODE TEMEL DEÄERLERÄ° */
    body[data-theme="dark"] {
      --ink: #f5f5f7;
      --subtle: #a1a1a6;
      --border-soft: rgba(255,255,255,0.14);
      --shadow-soft: 0 18px 46px rgba(0,0,0,0.7);
      background:
        radial-gradient(circle at 0 0, rgba(255,255,255,0.04) 0, transparent 55%),
        #000000;
      color: var(--ink);
    }

    .bg-hero {
      position: fixed;
      right: -120px;
      top: -80px;
      width: 560px;
      height: 560px;
      background-image: url("campus-hero.jpg");
      background-size: cover;
      background-position: center;
      filter: blur(8px) saturate(1.1);
      opacity: 0.8; /* daha gÃ¶rÃ¼nÃ¼r */
      transform: rotate(-4deg);
      pointer-events: none;
      z-index: -1;
      border-radius: 50%;
      mask-image: radial-gradient(circle at 50% 50%, #000 0, transparent 70%);
      -webkit-mask-image: radial-gradient(circle at 50% 50%, #000 0, transparent 70%);
    }

    body[data-theme="dark"] .bg-hero {
      opacity: 0.65;
      filter: blur(10px) saturate(1.15);
    }

    .top-nav {
      max-width: 1100px;
      margin: 18px auto 0;
      padding: 8px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 13px;
      color: var(--subtle);
    }

    .brand { display: flex; align-items: center; gap: 10px; }
    .brand-logo-img { height: 40px; width: auto; display: block; }
    .brand-text-main {
      font-size: 14px;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: #f5f5f7;
    }
    .brand-text-sub {
      font-size: 12px;
      color: var(--subtle);
    }

    .nav-right { display: flex; align-items: center; gap: 10px; }
    .nav-pill {
      padding: 4px 12px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.18);
      background: rgba(255,255,255,0.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: #f5f5f7;
      font-size: 12px;
      white-space: nowrap;
    }
    .nav-toggle {
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.3);
    }
    .nav-toggle:focus {
      outline: none;
      box-shadow: 0 0 0 2px rgba(0,113,227,0.3);
    }

    body[data-theme="light"] .nav-pill {
      border-color: rgba(0,0,0,0.08);
      background: rgba(255,255,255,0.65);
      color: #3a3a3c;
    }

    .page-wrapper {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 72px 16px 40px;
    }

    .card {
      width: 100%;
      max-width: 640px;
      background: #ffffff;
      border-radius: 32px;
      border: 1px solid var(--border-soft);
      box-shadow: var(--shadow-soft);
      padding: 28px 28px 22px;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -60px;
      background:
        radial-gradient(circle at 0 0, rgba(0,145,255,0.08) 0, transparent 55%),
        radial-gradient(circle at 100% 0, rgba(39,174,96,0.08) 0, transparent 55%);
      pointer-events: none;
      z-index: -1;
    }

    body[data-theme="dark"] .card {
      background: #1c1c1e;
      border-color: var(--border-soft);
    }
    body[data-theme="dark"] .card::before {
      background:
        radial-gradient(circle at 0 0, rgba(0,145,255,0.14) 0, transparent 55%),
        radial-gradient(circle at 100% 0, rgba(39,174,96,0.12) 0, transparent 55%);
    }

    .card-header {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 18px;
    }
    .tagline {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: #6e6e73;
    }
    .title {
      font-size: 24px;
      font-weight: 650;
      letter-spacing: -0.03em;
      color: #1d1d1f;
    }
    .subtitle {
      font-size: 13px;
      color: var(--subtle);
      max-width: 420px;
    }

    body[data-theme="dark"] .title {
      color: #f5f5f7;
    }
    body[data-theme="dark"] .subtitle {
      color: var(--subtle);
    }
    body[data-theme="dark"] .tagline {
      color: var(--subtle);
    }

    .tabs {
      display: inline-flex;
      border-radius: 999px;
      padding: 3px;
      background: #f5f5f7;
      margin-bottom: 16px;
    }
    .tab {
      border: none;
      background: transparent;
      padding: 6px 18px;
      font-size: 13px;
      border-radius: 999px;
      cursor: pointer;
      color: #3a3a3c;
    }
    .tab.active {
      background: #ffffff;
      box-shadow: 0 1px 4px rgba(0,0,0,0.08);
      color: #111;
    }

    body[data-theme="dark"] .tabs {
      background: #2c2c2e;
    }
    body[data-theme="dark"] .tab {
      color: #a1a1a6;
    }
    body[data-theme="dark"] .tab.active {
      background: #3a3a3c;
      color: #ffffff;
      box-shadow: 0 1px 4px rgba(0,0,0,0.5);
    }

    .auth-form { display: none; }
    .auth-form.active { display: block; }

    .form-group { margin-bottom: 14px; }
    .label {
      display: block;
      font-size: 13px;
      margin-bottom: 6px;
      color: #3a3a3c;
    }
    body[data-theme="dark"] .label {
      color: #f5f5f7;
    }

    .input {
      width: 100%;
      padding: 10px 14px;
      border-radius: 13px;
      border: 1px solid rgba(0,0,0,0.12);
      background: #f5f5f7;
      color: #111;
      font-size: 14px;
      outline: none;
      transition: border 150ms ease, box-shadow 150ms ease, background 150ms ease;
    }
    .input::placeholder { color: #9f9fa3; }
    .input:focus {
      border-color: #0071e3;
      background: #ffffff;
      box-shadow: 0 0 0 3px rgba(0,113,227,0.18);
    }

    body[data-theme="dark"] .input {
      background: #2c2c2e;
      border-color: rgba(255,255,255,0.16);
      color: #f5f5f7;
    }
    body[data-theme="dark"] .input::placeholder {
      color: #8e8e93;
    }
    body[data-theme="dark"] .input:focus {
      background: #1c1c1e;
      border-color: #0a84ff;
      box-shadow: 0 0 0 3px rgba(10,132,255,0.4);
    }

    .actions-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
      margin-bottom: 6px;
      align-items: center;
    }
    .btn {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 14px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      outline: none;
      transition: transform 120ms ease, box-shadow 120ms ease, background 160ms ease;
      white-space: nowrap;
    }
    .btn-primary {
      background: linear-gradient(135deg, #0071e3, #0f7fff);
      color: #fff;
      box-shadow: 0 10px 24px rgba(0,113,227,0.4);
    }
    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 34px rgba(0,113,227,0.5);
    }

    .btn-secondary {
      background: #f5f5f7;
      color: #111;
      border: 1px solid rgba(0,0,0,0.06);
    }
    .btn-secondary:hover {
      background: #e5e5ea;
      transform: translateY(-1px);
    }

    body[data-theme="dark"] .btn-secondary {
      background: #2c2c2e;
      color: #f5f5f7;
      border-color: rgba(255,255,255,0.16);
    }
    body[data-theme="dark"] .btn-secondary:hover {
      background: #3a3a3c;
    }

    .link-button {
      border: none;
      background: transparent;
      color: #0071e3;
      text-decoration: underline;
      padding: 0;
      font-size: 12px;
      cursor: pointer;
    }
    body[data-theme="dark"] .link-button {
      color: #0a84ff;
    }

    .checkbox-row {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 12px;
      color: var(--subtle);
    }
    .checkbox-label {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      font-size: 12px;
      color: var(--subtle);
      cursor: pointer;
    }
    .checkbox-label input[type="checkbox"] {
      margin-top: 2px;
      cursor: pointer;
    }

    .auth-message {
      margin-top: 10px;
      font-size: 12px;
      color: var(--subtle);
      min-height: 16px;
    }
    .auth-message.error { color: #d70015; }
    .auth-message.success { color: #1d9f3a; }

    body[data-theme="dark"] .auth-message {
      color: var(--subtle);
    }
    body[data-theme="dark"] .auth-message.error {
      color: #ff453a;
    }
    body[data-theme="dark"] .auth-message.success {
      color: #30d158;
    }

    /* SÃ¶zleÅŸme modalÄ± */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 30;
    }
    .modal-backdrop.visible {
      display: flex;
    }
    .modal-card {
      width: 100%;
      max-width: 680px;
      max-height: 80vh;
      background: #ffffff;
      border-radius: 24px;
      box-shadow: 0 24px 60px rgba(0,0,0,0.45);
      padding: 18px 20px 16px;
      display: flex;
      flex-direction: column;
    }
    body[data-theme="dark"] .modal-card {
      background: #1c1c1e;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    .modal-title {
      font-size: 16px;
      font-weight: 600;
      color: #1d1d1f;
    }
    body[data-theme="dark"] .modal-title {
      color: #f5f5f7;
    }
    .modal-close-btn {
      border: none;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 12px;
      cursor: pointer;
      background: #f5f5f7;
      color: #111;
    }
    body[data-theme="dark"] .modal-close-btn {
      background: #2c2c2e;
      color: #f5f5f7;
    }
    .modal-body {
      flex: 1;
      overflow: auto;
      font-size: 12px;
      color: #3a3a3c;
      padding-right: 4px;
    }
    body[data-theme="dark"] .modal-body {
      color: #e5e5ea;
    }
    .modal-body h3 {
      margin-top: 10px;
      margin-bottom: 4px;
      font-size: 13px;
    }
    .modal-body p {
      margin-top: 2px;
      margin-bottom: 6px;
      line-height: 1.4;
    }
    .modal-body ul {
      padding-left: 18px;
      margin-top: 2px;
      margin-bottom: 8px;
    }
    .modal-body li {
      margin-bottom: 3px;
    }
    .modal-footer {
      margin-top: 10px;
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      align-items: center;
      font-size: 12px;
      color: var(--subtle);
    }

    @media (max-width: 720px) {
      .top-nav { padding-inline: 12px; }
      .page-wrapper { padding-inline: 12px; }
      .card { padding-inline: 20px; border-radius: 24px; }
      .bg-hero { display: none; }
      .nav-right { gap: 6px; }
      .modal-card { max-width: 95%; max-height: 85vh; }
    }
  </style>
</head>
<body data-theme="light">
  <div class="bg-hero"></div>

  <header class="top-nav">
    <div class="brand">
      <img
        class="brand-logo-img"
        src="https://3fcampus.tau.edu.tr/uploads/cms/pr.tau/dgFfmceK6A.png"
        alt="TÃ¼rk-Alman Ãœniversitesi Logosu"
      />
      <div>
        <div class="brand-text-main">TÃ¼rk-Alman Ãœniversitesi</div>
        <div class="brand-text-sub" id="brandSub">Yemekhane Ã–deme Sistemi</div>
      </div>
    </div>
    <div class="nav-right">
      <span id="navCampusCard" class="nav-pill">CampusCard</span>
      <span class="nav-pill" id="navSecureLogin">GÃ¼venli GiriÅŸ</span>
      <button type="button" id="themeToggle" class="nav-pill nav-toggle">
        ğŸŒ™ Dark mode
      </button>
      <button type="button" id="langToggle" class="nav-pill nav-toggle">
        ğŸ‡¹ğŸ‡· TR
      </button>
    </div>
  </header>

  <main class="page-wrapper">
    <section class="card">
      <div class="card-header">
        <div class="tagline" id="tagline">TAÃœ Â· Yemekhane</div>
        <h1 class="title" id="mainTitle">GiriÅŸ yap veya yeni bir kampÃ¼s hesabÄ± oluÅŸtur.</h1>
        <p class="subtitle" id="subtitle">
          TAÃœ Ã¶ÄŸrenci veya personel e-postan ile giriÅŸ yapabilir; yemek bakiyeni yÃ¶netebilir, yÃ¼kleme yapabilir ve son iÅŸlemlerini gÃ¶rebilirsin.
        </p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="login" id="tabLogin">GiriÅŸ Yap</button>
        <button class="tab" data-tab="register" id="tabRegister">KayÄ±t Ol</button>
      </div>

      <!-- GiriÅŸ Formu -->
      <form id="loginForm" class="auth-form active">
        <div class="form-group">
          <label class="label" for="loginEmail" id="labelLoginEmail">E-posta</label>
          <input
            class="input"
            type="email"
            id="loginEmail"
            placeholder="ogrenci.no@tau.edu.tr"
            autocomplete="username"
            required
          />
        </div>
        <div class="form-group">
          <label class="label" for="loginPassword" id="labelLoginPassword">Åifre</label>
          <input
            class="input"
            type="password"
            id="loginPassword"
            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
            autocomplete="current-password"
            required
          />
        </div>
        <div class="actions-row">
          <button type="submit" class="btn btn-primary" id="loginSubmitBtn">GiriÅŸ Yap</button>
          <button type="button" class="btn btn-secondary" id="forgotBtn">
            Åifremi Unuttum
          </button>
        </div>
      </form>

      <!-- KayÄ±t Formu -->
      <form id="registerForm" class="auth-form">
        <div class="form-group">
          <label class="label" for="regName" id="regNameLabel">Ad Soyad</label>
          <input
            class="input"
            type="text"
            id="regName"
            placeholder="AdÄ±n SoyadÄ±n"
            required
          />
        </div>
        <div class="form-group">
          <label class="label" for="regStudentNo" id="regStudentNoLabel">Ã–ÄŸrenci No (opsiyonel)</label>
          <input
            class="input"
            type="text"
            id="regStudentNo"
            placeholder="2020xxxxxx"
          />
        </div>
        <div class="form-group">
          <label class="label" for="regEmail" id="regEmailLabel">TAÃœ E-posta</label>
          <input
            class="input"
            type="email"
            id="regEmail"
            placeholder="ogrenci.no@tau.edu.tr"
            autocomplete="email"
            required
          />
        </div>
        <div class="form-group">
          <label class="label" for="regPassword" id="regPasswordLabel">Åifre</label>
          <input
            class="input"
            type="password"
            id="regPassword"
            placeholder="En az 6 karakter"
            autocomplete="new-password"
            required
          />
        </div>
        <div class="form-group">
          <label class="label" for="regPassword2" id="regPassword2Label">Åifre (Tekrar)</label>
          <input
            class="input"
            type="password"
            id="regPassword2"
            placeholder="Åifreni tekrar yaz"
            required
          />
        </div>

        <!-- SÃ¶zleÅŸme kÄ±smÄ± -->
        <div class="form-group">
          <div class="checkbox-row">
            <button type="button" class="link-button" id="contractOpenBtn">
              Yemek bakiyesi sÃ¶zleÅŸmesini oku
            </button>
            <label class="checkbox-label">
              <input type="checkbox" id="contractAccept" />
              <span id="contractAcceptText">
                Yemek bakiyesi sÃ¶zleÅŸmesini okudum ve kabul ediyorum.
              </span>
            </label>
          </div>
        </div>

        <div class="actions-row">
          <button type="submit" class="btn btn-primary" id="registerSubmitBtn">KayÄ±t Ol</button>
          <span style="font-size:12px;color:var(--subtle);" id="registerInfoText">
            KayÄ±t olmadan Ã¶nce yemek bakiyesi sÃ¶zleÅŸmesini okuman ve kabul etmen gerekir.
          </span>
        </div>
      </form>

      <div id="authMessage" class="auth-message"></div>
    </section>
  </main>

  <!-- SÃ–ZLEÅME MODALI -->
  <div id="contractBackdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-header">
        <div class="modal-title" id="contractTitle">
          TAÃœ Yemekhane Â· Yemek Bakiyesi SÃ¶zleÅŸmesi
        </div>
        <button type="button" id="contractCloseBtn" class="modal-close-btn">Kapat</button>
      </div>
      <div class="modal-body">
        <h3>1. AmaÃ§ ve kapsam</h3>
        <p>
          Bu sÃ¶zleÅŸme, TÃ¼rk-Alman Ãœniversitesi (TAÃœ) yemekhane hizmetlerinde kullanÄ±lan
          dijital yemek bakiyesi sisteminin (â€œSistemâ€) kullanÄ±mÄ±na iliÅŸkin usul ve esaslarÄ±
          belirlemek amacÄ±yla hazÄ±rlanmÄ±ÅŸtÄ±r. Sistem, Ã¶ÄŸrencilerin ve personelin kampÃ¼s
          iÃ§erisindeki yemekhanelerde nakit para taÅŸÄ±maksÄ±zÄ±n Ã¶deme yapabilmesini saÄŸlar.
        </p>

        <h3>2. Hesap oluÅŸturma ve kimlik doÄŸrulama</h3>
        <ul>
          <li>Sisteme yalnÄ±zca TAÃœ tarafÄ±ndan verilmiÅŸ kurumsal e-posta adresleri ile kayÄ±t olunabilir.</li>
          <li>KullanÄ±cÄ±, kayÄ±t sÄ±rasÄ±nda beyan ettiÄŸi tÃ¼m bilgilerin doÄŸru ve gÃ¼ncel olduÄŸunu kabul eder.</li>
          <li>Hesap ÅŸifresinin gÃ¼venliÄŸini saÄŸlamak, tamamen kullanÄ±cÄ±nÄ±n sorumluluÄŸundadÄ±r.</li>
        </ul>

        <h3>3. Bakiye yÃ¼kleme ve kullanÄ±m</h3>
        <ul>
          <li>Yemek bakiyesi, sadece TAÃœ yemekhane ve ilgili kampÃ¼s iÃ§i satÄ±ÅŸ noktalarÄ±nda kullanÄ±lmak Ã¼zere tanÄ±mlanÄ±r.</li>
          <li>Bakiye, kullanÄ±cÄ± hesabÄ±na tanÄ±mlandÄ±ktan sonra yalnÄ±zca yemek ve ilgili hizmet alÄ±mlarÄ±nda kullanÄ±labilir; Ã¼Ã§Ã¼ncÃ¼ kiÅŸilere devredilemez veya nakde Ã§evrilemez.</li>
          <li>Premium Ã¼yelik, paket alÄ±mÄ± ve benzeri avantajlar, Sistem Ã¼zerinde belirtilen ÅŸart ve koÅŸullara tabidir.</li>
        </ul>

        <h3>4. Ä°ade ve iptal koÅŸullarÄ±</h3>
        <ul>
          <li>YapÄ±lmÄ±ÅŸ bir yemek harcamasÄ±nÄ±n, hizmetin fiilen sunulmasÄ±ndan sonra iadesi kural olarak mÃ¼mkÃ¼n deÄŸildir.</li>
          <li>YanlÄ±ÅŸ yÃ¼kleme, teknik hata veya mÃ¼kerrer iÅŸlem durumlarÄ±nda, kullanÄ±cÄ± ilgili birime baÅŸvurarak inceleme talep edebilir.</li>
        </ul>

        <h3>5. KiÅŸisel verilerin korunmasÄ±</h3>
        <ul>
          <li>Yemek bakiyesi sistemi kapsamÄ±ndaki kiÅŸisel veriler, yalnÄ±zca hizmetin sunulmasÄ±, iyileÅŸtirilmesi ve yasal yÃ¼kÃ¼mlÃ¼lÃ¼klerin yerine getirilmesi amacÄ±yla iÅŸlenir.</li>
          <li>KullanÄ±cÄ±, sistem kullanÄ±mÄ±na devam ederek, kiÅŸisel verilerinin bu amaÃ§larla iÅŸlenebileceÄŸini kabul eder.</li>
        </ul>

        <h3>6. Sorumluluk sÄ±nÄ±rÄ±</h3>
        <ul>
          <li>Sistem geÃ§ici bakÄ±m, gÃ¼ncelleme veya Ã¶ngÃ¶rÃ¼lemeyen teknik sebeplerle zaman zaman kullanÄ±lamaz hale gelebilir.</li>
          <li>KullanÄ±cÄ±, makul teknik Ã¶nlemler alÄ±nmÄ±ÅŸ olmak kaydÄ±yla, Sistemâ€™in kesintisiz Ã§alÄ±ÅŸacaÄŸÄ±na dair bir garanti verilmediÄŸini kabul eder.</li>
        </ul>

        <h3>7. DeÄŸiÅŸiklikler ve yÃ¼rÃ¼rlÃ¼k</h3>
        <ul>
          <li>Bu sÃ¶zleÅŸme hÃ¼kÃ¼mleri, gerekli gÃ¶rÃ¼lmesi halinde gÃ¼ncellenebilir veya deÄŸiÅŸtirilebilir.</li>
          <li>GÃ¼ncel metin Sistem Ã¼zerinde yayÄ±nlandÄ±ÄŸÄ± andan itibaren geÃ§erlidir; kullanÄ±cÄ± Sistemi kullanmaya devam ederek yeni ÅŸartlarÄ± kabul etmiÅŸ sayÄ±lÄ±r.</li>
        </ul>

        <p style="margin-top:10px;font-size:11px;opacity:0.8;">
          Not: Bu metin Ã¶rnek niteliÄŸinde bir taslaktÄ±r. Ãœniversitenin resmi metni
          ile Ã§eliÅŸmesi halinde, resmi metin esas alÄ±nÄ±r.
        </p>
      </div>
      <div class="modal-footer">
        <span id="contractFooterText">SÃ¶zleÅŸmeyi inceledikten sonra kabul edebilirsin.</span>
        <button type="button" id="contractAcceptBtn" class="btn btn-primary" style="font-size:13px;">
          Kabul Ediyorum
        </button>
      </div>
    </div>
  </div>

  <script>
    const bodyEl = document.body;
    const themeToggleBtn = document.getElementById("themeToggle");

    function applyTheme(theme) {
      bodyEl.dataset.theme = theme;
      if (themeToggleBtn) {
        if (theme === "dark") {
          themeToggleBtn.textContent = "â˜€ï¸ Light mode";
        } else {
          themeToggleBtn.textContent = "ğŸŒ™ Dark mode";
        }
      }
    }

    (function initTheme() {
      try {
        const saved = localStorage.getItem("tau-theme");
        const prefersDark =
          window.matchMedia &&
          window.matchMedia("(prefers-color-scheme: dark)").matches;
        const initial = saved || (prefersDark ? "dark" : "light");
        applyTheme(initial);
      } catch (e) {
        applyTheme("light");
      }
    })();

    if (themeToggleBtn) {
      themeToggleBtn.addEventListener("click", () => {
        const next = bodyEl.dataset.theme === "dark" ? "light" : "dark";
        applyTheme(next);
        try {
          localStorage.setItem("tau-theme", next);
        } catch (e) {}
      });
    }

    // --- i18n (TR / DE) ---
    const translations = {
      tr: {
        brandSub: "Yemekhane Ã–deme Sistemi",
        tagline: "TAÃœ Â· Yemekhane",
        title: "GiriÅŸ yap veya yeni bir kampÃ¼s hesabÄ± oluÅŸtur.",
        subtitle:
          "TAÃœ Ã¶ÄŸrenci veya personel e-postan ile giriÅŸ yapabilir; yemek bakiyeni yÃ¶netebilir, yÃ¼kleme yapabilir ve son iÅŸlemlerini gÃ¶rebilirsin.",
        navCampusCard: "CampusCard",
        navSecureLogin: "GÃ¼venli GiriÅŸ",
        tabLogin: "GiriÅŸ Yap",
        tabRegister: "KayÄ±t Ol",
        labelLoginEmail: "E-posta",
        labelLoginPassword: "Åifre",
        loginEmailPlaceholder: "ogrenci.no@tau.edu.tr",
        loginPasswordPlaceholder: "â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",
        loginBtn: "GiriÅŸ Yap",
        forgotBtn: "Åifremi Unuttum",
        regNameLabel: "Ad Soyad",
        regNamePlaceholder: "AdÄ±n SoyadÄ±n",
        regStudentNoLabel: "Ã–ÄŸrenci No (opsiyonel)",
        regStudentNoPlaceholder: "2020xxxxxx",
        regEmailLabel: "TAÃœ E-posta",
        regEmailPlaceholder: "ogrenci.no@tau.edu.tr",
        regPasswordLabel: "Åifre",
        regPasswordPlaceholder: "En az 6 karakter",
        regPassword2Label: "Åifre (Tekrar)",
        regPassword2Placeholder: "Åifreni tekrar yaz",
        registerInfoText:
          "KayÄ±t olmadan Ã¶nce yemek bakiyesi sÃ¶zleÅŸmesini okuman ve kabul etmen gerekir.",
        loginProcessing: "GiriÅŸ yapÄ±lÄ±yor...",
        loginSuccess: "GiriÅŸ baÅŸarÄ±lÄ±, panel aÃ§Ä±lÄ±yor...",
        loginErrorGeneric: "GiriÅŸ baÅŸarÄ±sÄ±z.",
        registerProcessing: "Hesap oluÅŸturuluyor...",
        registerSuccess: "Hesap oluÅŸturuldu, panel aÃ§Ä±lÄ±yor...",
        registerErrorGeneric: "KayÄ±t baÅŸarÄ±sÄ±z.",
        passwordMismatch: "Åifreler eÅŸleÅŸmiyor.",
        networkError: "Sunucuya baÄŸlanÄ±rken hata oluÅŸtu.",
        forgotInfo:
          "Åifremi unuttum akÄ±ÅŸÄ± bu demoâ€™da pasif. GerÃ§ekte e-posta ile sÄ±fÄ±rlama linki gÃ¶nderebilirsin.",
        contractOpen: "Yemek bakiyesi sÃ¶zleÅŸmesini oku",
        contractAcceptLabel:
          "Yemek bakiyesi sÃ¶zleÅŸmesini okudum ve kabul ediyorum.",
        contractRequired:
          "KayÄ±t olmak iÃ§in yemek bakiyesi sÃ¶zleÅŸmesini kabul etmelisin.",
        contractTitle: "TAÃœ Yemekhane Â· Yemek Bakiyesi SÃ¶zleÅŸmesi",
        contractFooterText:
          "SÃ¶zleÅŸmeyi inceledikten sonra kabul edebilirsin.",
      },
      de: {
        brandSub: "Mensa-Bezahlsystem",
        tagline: "TAU Â· Mensa",
        title: "Melde dich an oder erstelle ein neues Campus-Konto.",
        subtitle:
          "Du kannst dich mit deiner TAU-Studierenden- oder Mitarbeiter-E-Mail anmelden, dein Mensa-Guthaben verwalten, Aufladungen durchfÃ¼hren und deine letzten Transaktionen sehen.",
        navCampusCard: "CampusCard",
        navSecureLogin: "Sichere Anmeldung",
        tabLogin: "Anmelden",
        tabRegister: "Registrieren",
        labelLoginEmail: "E-Mail",
        labelLoginPassword: "Passwort",
        loginEmailPlaceholder: "studiennummer@tau.edu.tr",
        loginPasswordPlaceholder: "â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",
        loginBtn: "Anmelden",
        forgotBtn: "Passwort vergessen",
        regNameLabel: "Vor- und Nachname",
        regNamePlaceholder: "Dein Name",
        regStudentNoLabel: "Matrikelnummer (optional)",
        regStudentNoPlaceholder: "2020xxxxxx",
        regEmailLabel: "TAU-E-Mail",
        regEmailPlaceholder: "studiennummer@tau.edu.tr",
        regPasswordLabel: "Passwort",
        regPasswordPlaceholder: "Mindestens 6 Zeichen",
        regPassword2Label: "Passwort (Wiederholen)",
        regPassword2Placeholder: "Passwort erneut eingeben",
        registerInfoText:
          "Bitte lies den Mensa-Guthabenvertrag und akzeptiere ihn, bevor du dich registrierst.",
        loginProcessing: "Anmeldung lÃ¤uft...",
        loginSuccess: "Anmeldung erfolgreich, das Panel wird geÃ¶ffnet...",
        loginErrorGeneric: "Anmeldung fehlgeschlagen.",
        registerProcessing: "Konto wird erstellt...",
        registerSuccess: "Konto erstellt, das Panel wird geÃ¶ffnet...",
        registerErrorGeneric: "Registrierung fehlgeschlagen.",
        passwordMismatch: "Die PasswÃ¶rter stimmen nicht Ã¼berein.",
        networkError:
          "Beim Verbinden mit dem Server ist ein Fehler aufgetreten.",
        forgotInfo:
          "Der â€Passwort vergessenâ€œ-Ablauf ist in dieser Demo deaktiviert. In echt kÃ¶nntest du hier einen Link per E-Mail versenden.",
        contractOpen: "Mensa-Guthabenvertrag lesen",
        contractAcceptLabel:
          "Ich habe den Mensa-Guthabenvertrag gelesen und akzeptiere ihn.",
        contractRequired:
          "Du musst den Mensa-Guthabenvertrag akzeptieren, um dich zu registrieren.",
        contractTitle: "TAU Mensa Â· Guthabenvereinbarung",
        contractFooterText:
          "Lies dir den Vertrag durch und bestÃ¤tige ihn anschlieÃŸend.",
      }
    };

    let currentLang = "tr";
    const langToggleBtn = document.getElementById("langToggle");

    function t(key) {
      const dict = translations[currentLang] || translations.tr;
      return dict[key] || key;
    }

    function applyLanguage(lang) {
      currentLang = lang;
      document.documentElement.lang = lang === "de" ? "de" : "tr";
      const dict = translations[lang] || translations.tr;
      const el = (id) => document.getElementById(id);

      if (el("brandSub")) el("brandSub").textContent = dict.brandSub;
      if (el("tagline")) el("tagline").textContent = dict.tagline;
      if (el("mainTitle")) el("mainTitle").textContent = dict.title;
      if (el("subtitle")) el("subtitle").textContent = dict.subtitle;

      if (el("navCampusCard")) el("navCampusCard").textContent = dict.navCampusCard;
      if (el("navSecureLogin")) el("navSecureLogin").textContent = dict.navSecureLogin;

      if (el("tabLogin")) el("tabLogin").textContent = dict.tabLogin;
      if (el("tabRegister")) el("tabRegister").textContent = dict.tabRegister;

      if (el("labelLoginEmail")) el("labelLoginEmail").textContent = dict.labelLoginEmail;
      if (el("labelLoginPassword")) el("labelLoginPassword").textContent = dict.labelLoginPassword;

      const loginEmailInput = el("loginEmail");
      if (loginEmailInput) loginEmailInput.placeholder = dict.loginEmailPlaceholder;
      const loginPasswordInput = el("loginPassword");
      if (loginPasswordInput) loginPasswordInput.placeholder = dict.loginPasswordPlaceholder;

      const loginBtnEl = el("loginSubmitBtn");
      if (loginBtnEl) loginBtnEl.textContent = dict.loginBtn;
      const forgotBtnEl = el("forgotBtn");
      if (forgotBtnEl) forgotBtnEl.textContent = dict.forgotBtn;

      if (el("regNameLabel")) el("regNameLabel").textContent = dict.regNameLabel;
      const regNameInput = el("regName");
      if (regNameInput) regNameInput.placeholder = dict.regNamePlaceholder;

      if (el("regStudentNoLabel")) el("regStudentNoLabel").textContent = dict.regStudentNoLabel;
      const regStudentNoInput = el("regStudentNo");
      if (regStudentNoInput) regStudentNoInput.placeholder = dict.regStudentNoPlaceholder;

      if (el("regEmailLabel")) el("regEmailLabel").textContent = dict.regEmailLabel;
      const regEmailInput = el("regEmail");
      if (regEmailInput) regEmailInput.placeholder = dict.regEmailPlaceholder;

      if (el("regPasswordLabel")) el("regPasswordLabel").textContent = dict.regPasswordLabel;
      const regPasswordInput = el("regPassword");
      if (regPasswordInput) regPasswordInput.placeholder = dict.regPasswordPlaceholder;

      if (el("regPassword2Label")) el("regPassword2Label").textContent = dict.regPassword2Label;
      const regPassword2Input = el("regPassword2");
      if (regPassword2Input) regPassword2Input.placeholder = dict.regPassword2Placeholder;

      if (el("registerSubmitBtn")) el("registerSubmitBtn").textContent = dict.tabRegister;
      if (el("registerInfoText")) el("registerInfoText").textContent = dict.registerInfoText;

      if (el("contractOpenBtn")) el("contractOpenBtn").textContent = dict.contractOpen;
      if (el("contractAcceptText")) el("contractAcceptText").textContent = dict.contractAcceptLabel;
      if (el("contractTitle")) el("contractTitle").textContent = dict.contractTitle;
      if (el("contractFooterText")) el("contractFooterText").textContent = dict.contractFooterText;

      if (langToggleBtn) {
        langToggleBtn.textContent = lang === "tr" ? "ğŸ‡¹ğŸ‡· TR" : "ğŸ‡©ğŸ‡ª DE";
      }
    }

    (function initLang() {
      try {
        const saved = localStorage.getItem("tau-lang");
        const initial = saved === "de" ? "de" : "tr";
        applyLanguage(initial);
      } catch (e) {
        applyLanguage("tr");
      }
    })();

    if (langToggleBtn) {
      langToggleBtn.addEventListener("click", () => {
        const next = currentLang === "tr" ? "de" : "tr";
        applyLanguage(next);
        try {
          localStorage.setItem("tau-lang", next);
        } catch (e) {}
      });
    }

    // Tab geÃ§iÅŸleri
    const tabs = document.querySelectorAll(".tab");
    const forms = document.querySelectorAll(".auth-form");
    const authMsg = document.getElementById("authMessage");

    tabs.forEach((tab) => {
      tab.addEventListener("click", () => {
        tabs.forEach((t) => t.classList.remove("active"));
        tab.classList.add("active");
        const target = tab.dataset.tab;
        forms.forEach((form) => {
          form.classList.toggle("active", form.id === target + "Form");
        });
        authMsg.textContent = "";
        authMsg.className = "auth-message";
      });
    });

    function showMessage(text, type = "info") {
      authMsg.textContent = text;
      authMsg.className = "auth-message " + (type === "error" ? "error" : "success");
    }

    // Login
    const loginForm = document.getElementById("loginForm");
    loginForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      showMessage(t("loginProcessing"));
      const email = document.getElementById("loginEmail").value.trim();
      const password = document.getElementById("loginPassword").value;

      try {
        const res = await fetch("/api/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password }),
        });
        const data = await res.json();
        if (!res.ok) {
          showMessage(data.error || t("loginErrorGeneric"), "error");
          return;
        }
        showMessage(t("loginSuccess"), "success");
        window.location.href = "/panel.html";
      } catch (err) {
        showMessage(t("networkError"), "error");
      }
    });

    // Register
    const regForm = document.getElementById("registerForm");
    const contractAcceptCheckbox = document.getElementById("contractAccept");

    regForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      showMessage(t("registerProcessing"));
      const name = document.getElementById("regName").value.trim();
      const studentNo = document.getElementById("regStudentNo").value.trim();
      const email = document.getElementById("regEmail").value.trim();
      const password = document.getElementById("regPassword").value;
      const password2 = document.getElementById("regPassword2").value;

      if (password !== password2) {
        showMessage(t("passwordMismatch"), "error");
        return;
      }

      if (!contractAcceptCheckbox.checked) {
        showMessage(t("contractRequired"), "error");
        return;
      }

      try {
        const res = await fetch("/api/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, email, studentNo, password }),
        });
        const data = await res.json();
        if (!res.ok) {
          showMessage(data.error || t("registerErrorGeneric"), "error");
          return;
        }
        showMessage(t("registerSuccess"), "success");
        window.location.href = "/panel.html";
      } catch (err) {
        showMessage(t("networkError"), "error");
      }
    });

    // Åifremi unuttum (demo)
    document.getElementById("forgotBtn").addEventListener("click", () => {
      showMessage(t("forgotInfo"), "error");
    });

    // SÃ¶zleÅŸme modalÄ±
    const contractBackdrop = document.getElementById("contractBackdrop");
    const contractOpenBtn = document.getElementById("contractOpenBtn");
    const contractCloseBtn = document.getElementById("contractCloseBtn");
    const contractAcceptBtn = document.getElementById("contractAcceptBtn");

    function openContractModal() {
      contractBackdrop.classList.add("visible");
      contractBackdrop.setAttribute("aria-hidden", "false");
    }
    function closeContractModal() {
      contractBackdrop.classList.remove("visible");
      contractBackdrop.setAttribute("aria-hidden", "true");
    }

    if (contractOpenBtn) {
      contractOpenBtn.addEventListener("click", openContractModal);
    }
    if (contractCloseBtn) {
      contractCloseBtn.addEventListener("click", closeContractModal);
    }
    if (contractBackdrop) {
      contractBackdrop.addEventListener("click", (e) => {
        if (e.target === contractBackdrop) {
          closeContractModal();
        }
      });
    }
    if (contractAcceptBtn) {
      contractAcceptBtn.addEventListener("click", () => {
        contractAcceptCheckbox.checked = true;
        closeContractModal();
      });
    }
        // --- GÃœNÃœN MESAJI (Random quote API) ---

    async function loadDailyMessage() {
      const dailyTextInner = document.getElementById("dailyTextInner");
      const dailyLoader = document.getElementById("dailyLoader");
      if (!dailyTextInner) return;

      // Ä°lk aÃ§Ä±lÄ±ÅŸta localized "YÃ¼kleniyor..." / "Wird geladen..."
      dailyTextInner.textContent = t("dailyLoading");
      if (dailyLoader) dailyLoader.style.display = "inline-block";

      try {
        // Basit, auth istemeyen bir API: https://api.quotable.io
        const res = await fetch(
          "https://api.quotable.io/random?tags=inspirational|happiness|wisdom"
        );
        if (!res.ok) throw new Error("Bad status");
        const data = await res.json();

        const text = data.content;
        const author = data.author;

        dailyTextInner.textContent = text + (author ? " â€” " + author : "");
        dailyTextInner.dataset.hasQuote = "1";
        if (dailyLoader) dailyLoader.style.display = "none";
      } catch (err) {
        // Ä°nternet yok / okul aÄŸÄ± dÄ±ÅŸ isteÄŸi bloklarsa:
        dailyTextInner.textContent = t("dailyError");
        if (dailyLoader) dailyLoader.style.display = "none";
      }
    }

    // Sayfa yÃ¼klendiÄŸinde Ã§aÄŸÄ±r
    document.addEventListener("DOMContentLoaded", loadDailyMessage);
</script>
</body>
</html>
